"use strict";(self.webpackChunks06_station=self.webpackChunks06_station||[]).push([[2240,11371,62315,68479],{2240:(e,t,i)=>{i.r(t),i.d(t,{default:()=>_});var s=i(35143),l=i(50346),n=i(46053),a=(i(81806),i(76460),i(47249),i(85842)),r=i(25329),o=i(11371),c=i(94126),d=i(98108),u=i(87540),h=(i(76099),i(63582)),y=i(54761);const p="esri-slice",v={base:p,actions:"".concat(p,"__actions"),cancelButton:"".concat(p,"__cancel-button"),container:"".concat(p,"__container"),error:"".concat(p,"__error"),excludeButton:"".concat(p,"__exclude-button"),hint:"".concat(p,"__hint"),hintText:"".concat(p,"__hint-text"),layerItem:"".concat(p,"__layer-item"),layerList:"".concat(p,"__layer-list"),layerListHeading:"".concat(p,"__layer-list-title"),newSliceButton:"".concat(p,"__clear-button")};let w=class extends r.default{constructor(e,t){super(e,t),this.headingLevel=3,this.messages=null,this.viewModel=new o.default,this._onNewSliceClick=()=>{(0,l.ignoreAbortErrors)(this.viewModel.start())}}loadDependencies(){return(0,c.W)({action:()=>Promise.resolve().then(i.bind(i,85375)),button:()=>Promise.resolve().then(i.bind(i,43285)),"list-item":()=>Promise.resolve().then(i.bind(i,70205)),list:()=>Promise.all([i.e(38841),i.e(65641),i.e(75802)]).then(i.bind(i,75802))})}get active(){return this.viewModel.active}get analysis(){return this.viewModel.analysis}set analysis(e){this.viewModel.analysis=e}get excludedLayers(){return this.viewModel.excludedLayers}set excludedLayers(e){this.viewModel.excludedLayers=e}get excludeGroundSurface(){return this.viewModel.excludeGroundSurface}set excludeGroundSurface(e){this.viewModel.excludeGroundSurface=e}get icon(){return"slice"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e,t;return null!==(e=null===(t=this.messages)||void 0===t?void 0:t.widgetLabel)&&void 0!==e?e:""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get visible(){return this.viewModel.visible}set visible(e){this.viewModel.visible=e}get hasVoxelLayers(){var e;const t=null===(e=this.viewModel)||void 0===e?void 0:e.view;return null!=t&&t.allLayerViews.some(e=>"voxel-3d"===e.type)}render(){return(0,y.K)("div",{class:this.classes(v.base,d.D.widget,d.D.panel),role:"presentation"},this.visible?(0,y.K)("div",{class:v.container},this.viewModel.supported?[this._renderHint(),this._renderLayerList(),this._renderActions()]:this._renderUnsupported()):null)}_renderUnsupported(){return(0,y.K)("div",{class:v.error,key:"unsupported"},(0,y.K)("p",null,this.messages.unsupported))}_renderHint(){const{hasVoxelLayers:e,messages:t,viewModel:i}=this,{active:s,layersMode:l,state:n}=i;let a=null;return s&&("exclude"===l?a=t.excludeHint:"ready"===n&&(a=e?t.voxelHint:t.hint)),a?(0,y.K)("div",{class:v.hint,key:"hint"},(0,y.K)("p",{class:v.hintText},a),(0,y.K)("p",{class:v.hintText},t.verticalHint)):null}_renderLayerList(){const{excludedLayers:e,excludeGroundSurface:t,headingLevel:i,messages:s,viewModel:l}=this,{layersMode:n,state:a}=l,r="slicing"===a||"sliced"===a,o=e?e.toArray().map(e=>this._renderLayerItem({uid:e.uid,title:e.title,onClick:()=>(this.excludedLayers.remove(e),!1)})):[];return t&&o.push(this._renderLayerItem({uid:"ground",title:s.ground,onClick:()=>(this.excludeGroundSurface=!1,!1)})),"exclude"!==n&&r&&0!==o.length?(0,y.K)("div",{class:v.layerList,key:"settings"},(0,y.K)(u.D,{class:v.layerListHeading,level:i},s.excludedLayers),(0,y.K)("calcite-list",{label:s.excludedLayers,selectionMode:"none"},o)):null}_renderActions(){const{messages:e,viewModel:t}=this,{active:i,state:s}=t,l="disabled"===s,n="slicing"===s||"sliced"===s,a="exclude"===t.layersMode,r=[];return i&&!n||a||r.push((0,y.K)("calcite-button",{class:v.newSliceButton,disabled:l,key:"new-slice",onclick:this._onNewSliceClick},e.newSlice)),n&&!a&&r.push((0,y.K)("calcite-button",{appearance:"outline-fill",class:v.excludeButton,disabled:l,key:"exclude",onclick:()=>t.enterExcludeLayerMode()},e.excludeLayer)),i&&a&&r.push((0,y.K)("calcite-button",{appearance:"outline-fill",class:v.cancelButton,disabled:l,key:"cancel-exclude",onclick:()=>t.exitExcludeLayerMode()},e.cancel)),0===r.length?null:(0,y.K)("div",{class:v.actions},r)}_renderLayerItem(e){var t;const i=this.messages.includeLayer;return(0,y.K)("calcite-list-item",{class:v.layerItem,"data-testid":"list-item-".concat(e.uid),key:e.uid,label:null!==(t=e.title)&&void 0!==t?t:""},(0,y.K)("calcite-action",{icon:"x",onclick:e.onClick,scale:"s",slot:"actions-end",text:i,title:i}))}};(0,s._)([(0,n.MZ)()],w.prototype,"active",null),(0,s._)([(0,n.MZ)({constructOnly:!0,nonNullable:!0})],w.prototype,"analysis",null),(0,s._)([(0,n.MZ)()],w.prototype,"excludedLayers",null),(0,s._)([(0,n.MZ)()],w.prototype,"excludeGroundSurface",null),(0,s._)([(0,n.MZ)()],w.prototype,"headingLevel",void 0),(0,s._)([(0,n.MZ)()],w.prototype,"icon",null),(0,s._)([(0,n.MZ)()],w.prototype,"label",null),(0,s._)([(0,n.MZ)(),(0,h.G)("esri/widgets/Slice/t9n/Slice")],w.prototype,"messages",void 0),(0,s._)([(0,n.MZ)()],w.prototype,"view",null),(0,s._)([(0,n.MZ)({type:o.default})],w.prototype,"viewModel",void 0),(0,s._)([(0,n.MZ)()],w.prototype,"visible",null),(0,s._)([(0,n.MZ)()],w.prototype,"hasVoxelLayers",null),w=(0,s._)([(0,a.$)("esri.widgets.Slice")],w);const _=w},11371:(e,t,i)=>{i.r(t),i.d(t,{default:()=>u});var s=i(35143),l=i(68479),n=i(19276),a=i(46053),r=(i(81806),i(76460),i(47249),i(85842)),o=i(29078);const c=new Set;let d=class extends o.D{constructor(e){super(e),this.analysis=null,this.supportedViewType="3d",this.unsupportedErrorMessage="SliceViewModel is only supported in 3D views.",c.add(this)}destroy(){c.delete(this)}get state(){return this.disabled||!this.ready?"disabled":null==this.tool?"ready":this.tool.state}get shape(){return this.analysis.shape}set shape(e){this.analysis.shape=e}get tiltEnabled(){return this.analysis.tiltEnabled}set tiltEnabled(e){this.analysis.tiltEnabled=e}get layersMode(){var e,t;return null!==(e=null===(t=this.tool)||void 0===t?void 0:t.layersMode)&&void 0!==e?e:"none"}get excludedLayers(){return this.analysis.excludedLayers}set excludedLayers(e){this.analysis.excludedLayers=n.default.isCollection(e)?e:new n.default(e)}get excludeGroundSurface(){return this.analysis.excludeGroundSurface}set excludeGroundSurface(e){this.analysis.excludeGroundSurface=e}async start(){await super.start(),c.forEach(e=>{e.view===this.view&&e!==this&&e.clear()}),null!=this.analysisView&&(this.analysisView.active=!0)}enterExcludeLayerMode(){null!=this.tool&&this.tool.enterExcludeLayerMode()}exitExcludeLayerMode(){null!=this.tool&&this.tool.exitExcludeLayerMode()}onConnectToAnalysisView(e){e.active=!0}constructAnalysis(){return new l.default}};(0,s._)([(0,a.MZ)({type:l.default})],d.prototype,"analysis",void 0),(0,s._)([(0,a.MZ)({readOnly:!0})],d.prototype,"state",null),(0,s._)([(0,a.MZ)()],d.prototype,"shape",null),(0,s._)([(0,a.MZ)()],d.prototype,"tiltEnabled",null),(0,s._)([(0,a.MZ)()],d.prototype,"layersMode",null),(0,s._)([(0,a.MZ)()],d.prototype,"excludedLayers",null),(0,s._)([(0,a.MZ)({nonNullable:!0})],d.prototype,"excludeGroundSurface",null),d=(0,s._)([(0,r.$)("esri.widgets.Slice.SliceViewModel")],d);const u=d},29078:(e,t,i)=>{i.d(t,{D:()=>w});var s=i(53986),l=i(35143),n=i(91967),a=i(98773),r=(i(81806),i(76460)),o=i(30726),c=i(50346),d=i(68134),u=i(46053),h=(i(47249),i(85842));const y=["analysis"];var p,v;(v=p||(p={}))[v.PENDING=0]="PENDING",v[v.WAIT_FOR_VIEW_READY=1]="WAIT_FOR_VIEW_READY",v[v.RUNNING=2]="RUNNING";let w=class extends n.default{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(e),this.view=null,this.analysisView=null,this._reconnectViewTask=null,this._forceInteractiveHandle=null,this._parentChangeFromReconnect=!1,this._startUserOperation=null;const t=null===e||void 0===e?void 0:e.analysis;null!=t?this.analysis=t:(this._set("analysis",this.constructAnalysis()),this._set("isAnalysisOwner",!0)),null!=(null===e||void 0===e?void 0:e.visible)&&(this.visible=e.visible)}normalizeCtorArgs(e){const{analysis:t}=e;return(0,s.A)(e,y)}initialize(){this.addHandles([(0,d.watch)(()=>({readyAndNotSupported:null!=this.view&&this.view.ready&&!this.supported}),e=>{let{readyAndNotSupported:t}=e;t&&r.A.getLogger(this).errorOnce(this.unsupportedErrorMessage)},d.syncAndInitial),(0,d.watch)(()=>{var e;return null===(e=this.analysis)||void 0===e?void 0:e.parent},e=>{this._parentChangeFromReconnect||e===this.view||this._set("isAnalysisOwner",!1);const t=!this._parentChangeFromReconnect;this._parentChangeFromReconnect=!1,t&&this._scheduleViewReconnect()},d.sync),(0,d.watch)(()=>({view:this.view,ready:null!=this.view&&this.view.ready,supported:this.supported}),(e,t)=>{let{view:i}=e;const s=null===t||void 0===t?void 0:t.view;i!==s&&(this._startUserOperation=(0,o.DC)(this._startUserOperation),this._disconnectFromView(s)),this._scheduleViewReconnect()},d.syncAndInitial)])}destroy(){this._reconnectViewTask=(0,o.DC)(this._reconnectViewTask),this._startUserOperation=(0,o.DC)(this._startUserOperation),null!=this.analysisView&&(this.analysisView.visible=void 0),this._disconnectFromView(this.view),this._set("view",null),null!=this.analysis&&this.isAnalysisOwner&&(this.analysis.destroy(),this._set("analysis",null))}get supported(){return null==this.view||this.view.type===this.supportedViewType}set visible(e){this._set("visible",e),null!=this.analysisView&&(this.analysisView.visible=e)}get active(){return null!=this.tool&&this.tool.active}get disabled(){return null==this.view||!this.view.ready||!this.supported}set analysis(e){e!==this._get("analysis")&&(this._startUserOperation=(0,o.DC)(this._startUserOperation),this._disconnectFromView(this.view),this._setExternalAnalysis(e),this._scheduleViewReconnect())}get ready(){return null!=this.analysisView&&!this.connectingToView}get connectingToView(){return null!=this._reconnectViewTask}get isAnalysisOwner(){return this._get("isAnalysisOwner")}get tool(){return null!=this.analysisView?this.analysisView.tool:null}clear(){this._startUserOperation=(0,o.DC)(this._startUserOperation),this._resetInteractiveCreationState(),null!=this.tool&&null!=this.view&&this.view.activeTool===this.tool&&(this.view.activeTool=null)}async start(){if(!this.visible)return void r.A.getLogger(this).warn("Cannot start analysis when not visible");this.clear();const e={task:null,abort:null,state:p.PENDING},t=(0,a.UT)(async t=>{if(e.state=p.WAIT_FOR_VIEW_READY,await(0,d.whenOnce)(()=>this.ready,t),e.state=p.RUNNING,null==this.analysisView||null==this.view)return;const i=this.analysisView.tool;null!=i&&(this.view.activeTool=i,(0,d.when)(()=>i.created,()=>{i.active&&null!=this.view&&(this.view.activeTool=null)},{initial:!0,once:!0}))});return e.task=t,e.abort=()=>t.abort(),this._startUserOperation=e,t.promise}onConnectToAnalysisView(e){}onDisconnectFromAnalysisView(){}_scheduleViewReconnect(){this._reconnectViewTask=(0,o.DC)(this._reconnectViewTask);const e=(0,a.UT)(async t=>{try{await this._reconnectView(t)}catch(i){if((0,c.throwIfAborted)(t),!(0,c.isAbortError)(i))return void r.A.getLogger(this).warn("Failed to use analysis in view model",i);throw i}finally{e===this._reconnectViewTask&&(this._reconnectViewTask=null)}});this._reconnectViewTask=e}async _reconnectView(e){const{view:t}=this,i=null!=t&&t.ready&&this.supported,s=this.analysis;if(this._startUserOperation=_(this._startUserOperation),this._disconnectFromView(t),i&&null!=t&&null!=s){if(this.isAnalysisOwner){if(null!=s.parent)return void r.A.getLogger(this).errorOnce("expected owned analysis to have null parent when connecting to view");this._parentChangeFromReconnect=!0,t.analyses.add(s)}this.analysisView=await t.whenAnalysisView(s),(0,c.isAborted)(e)?this._startUserOperation=_(this._startUserOperation):(this.analysisView.visible=this.visible,this._forceInteractiveHandle=this.analysisView.forceInteractiveForViewModel(),this.addHandles(this._forceInteractiveHandle),this.onConnectToAnalysisView(this.analysisView))}}_disconnectFromView(e){null!=e&&this.isAnalysisOwner&&e.analyses.includes(this.analysis)&&(this._parentChangeFromReconnect=!0,this.analysis.clear(),e.analyses.remove(this.analysis)),this.onDisconnectFromAnalysisView(),this._forceInteractiveHandle=(0,o.xt)(this._forceInteractiveHandle),this.analysisView=null}_setExternalAnalysis(e){null==this.analysisView||this.isAnalysisOwner||(this.analysisView.visible=void 0,this._forceInteractiveHandle=(0,o.xt)(this._forceInteractiveHandle)),this.analysisView=null,this._set("isAnalysisOwner",!1),this._set("analysis",e),this._parentChangeFromReconnect=!1}_resetInteractiveCreationState(){this.analysis.clear(),null!=this.tool&&this.tool.resetCreated()}get testInfo(){}};function _(e){return null!=e&&e.state>=p.RUNNING?(e.abort(),null):e}(0,l._)([(0,u.MZ)()],w.prototype,"supported",null),(0,l._)([(0,u.MZ)()],w.prototype,"view",void 0),(0,l._)([(0,u.MZ)({type:Boolean,value:!0})],w.prototype,"visible",null),(0,l._)([(0,u.MZ)()],w.prototype,"active",null),(0,l._)([(0,u.MZ)()],w.prototype,"disabled",null),(0,l._)([(0,u.MZ)({nonNullable:!0})],w.prototype,"analysis",null),(0,l._)([(0,u.MZ)()],w.prototype,"analysisView",void 0),(0,l._)([(0,u.MZ)()],w.prototype,"ready",null),(0,l._)([(0,u.MZ)()],w.prototype,"connectingToView",null),(0,l._)([(0,u.MZ)({readOnly:!0})],w.prototype,"isAnalysisOwner",null),(0,l._)([(0,u.MZ)()],w.prototype,"_reconnectViewTask",void 0),(0,l._)([(0,u.MZ)()],w.prototype,"_forceInteractiveHandle",void 0),(0,l._)([(0,u.MZ)()],w.prototype,"tool",null),w=(0,l._)([(0,h.$)("esri.widgets.support.AnalysisViewModel")],w)},62315:(e,t,i)=>{i.r(t),i.d(t,{default:()=>v});var s=i(35143),l=i(69098),n=i(73582),a=i(42553),r=i(30726),o=i(46053),c=i(21403),d=(i(81806),i(47249),i(85842)),u=i(40565),h=i(37546),y=i(19247);let p=class extends(l.A.ClonableMixin(a.A)){constructor(e){super(e),this.type="plane",this.position=null,this.heading=0,this.tilt=0,this.width=10,this.height=10}equals(e){return this.heading===e.heading&&this.tilt===e.tilt&&(0,r.CM)(this.position,e.position)&&this.width===e.width&&this.height===e.height}};(0,s._)([(0,o.MZ)({readOnly:!0,json:{read:!1,write:!0}})],p.prototype,"type",void 0),(0,s._)([(0,o.MZ)({type:y.default}),(0,h.P)()],p.prototype,"position",void 0),(0,s._)([(0,o.MZ)({type:Number,nonNullable:!0,range:{min:0,max:360}}),(0,h.P)(),(0,c.w)(e=>n.ie.normalize((0,u.GB)(e),0,!0))],p.prototype,"heading",void 0),(0,s._)([(0,o.MZ)({type:Number,nonNullable:!0,range:{min:0,max:360}}),(0,h.P)(),(0,c.w)(e=>n.ie.normalize((0,u.GB)(e),0,!0))],p.prototype,"tilt",void 0),(0,s._)([(0,o.MZ)({type:Number,nonNullable:!0}),(0,h.P)()],p.prototype,"width",void 0),(0,s._)([(0,o.MZ)({type:Number,nonNullable:!0}),(0,h.P)()],p.prototype,"height",void 0),p=(0,s._)([(0,d.$)("esri.analysis.SlicePlane")],p);const v=p},68479:(e,t,i)=>{i.r(t),i.d(t,{default:()=>u});var s=i(35143),l=i(95085),n=i(62315),a=i(19276),r=i(3975),o=i(46053),c=(i(81806),i(76460),i(47249),i(85842));let d=class extends l.A{constructor(e){super(e),this.type="slice",this.tiltEnabled=!1,this.shape=null,this.excludeGroundSurface=!1}get excludedLayers(){return this._get("excludedLayers")||new a.default}set excludedLayers(e){this._set("excludedLayers",(0,r.V)(e,this._get("excludedLayers")))}get requiredPropertiesForEditing(){var e;return[null===(e=this.shape)||void 0===e?void 0:e.position]}clear(){this.shape=null}};(0,s._)([(0,o.MZ)({type:["slice"]})],d.prototype,"type",void 0),(0,s._)([(0,o.MZ)()],d.prototype,"tiltEnabled",void 0),(0,s._)([(0,o.MZ)({types:{key:"type",base:null,typeMap:{plane:n.default},defaultKeyValue:"plane"}})],d.prototype,"shape",void 0),(0,s._)([(0,o.MZ)({cast:r.H,clonable:e=>e.slice()})],d.prototype,"excludedLayers",null),(0,s._)([(0,o.MZ)({type:Boolean,nonNullable:!0})],d.prototype,"excludeGroundSurface",void 0),(0,s._)([(0,o.MZ)({readOnly:!0})],d.prototype,"requiredPropertiesForEditing",null),d=(0,s._)([(0,c.$)("esri.analysis.SliceAnalysis")],d);const u=d}}]);
//# sourceMappingURL=2240.5da4c743.chunk.js.map