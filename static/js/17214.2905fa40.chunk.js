"use strict";(self.webpackChunks06_station=self.webpackChunks06_station||[]).push([[17214,98156],{17214:(t,e,n)=>{n.r(e),n.d(e,{default:()=>f});var i=n(35143),l=n(50076),o=n(50346),r=n(46053),u=(n(81806),n(76460),n(47249),n(85842)),a=n(19247),s=n(43543),d=n(59844),m=n(68295),c=n(2257);const f=t=>{let e=class extends t{constructor(){super(...arguments),this.view=null}get timeExtent(){var t;return(0,s.F)(this.layer,null===(t=this.view)||void 0===t?void 0:t.timeExtent,this._get("timeExtent"))}async fetchPopupFeaturesAtLocation(t,e){const{layer:n}=this;if(!t)throw new l.default("imagerylayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:n});const{popupEnabled:i}=n,r=(0,c.D8)(n,e);if(!i||null==r)return[];const u=await r.getRequiredFields();(0,o.throwIfAborted)(e);const s=new m.default;s.timeExtent=this.timeExtent,s.geometry=t,s.outFields=u,s.outSpatialReference=t.spatialReference;const{resolution:d,spatialReference:f}=this.view,v="2d"===this.view.type?new a.default(d,d,f):new a.default(.5*d,.5*d,f),{returnTopmostRaster:p,showNoDataRecords:w}=r.layerOptions||{returnTopmostRaster:!0,showNoDataRecords:!1},y={returnDomainValues:!0,returnTopmostRaster:p,pixelSize:v,showNoDataRecords:w,signal:null===e||void 0===e?void 0:e.signal};return n.queryVisibleRasters(s,y).then(t=>t)}async getSourceScale(){return await(0,d.Hh)(),await this.layer.load(),(0,d.OO)(this.layer.serviceRasterInfo,this.view.spatialReference)}canResume(){var t;return!!super.canResume()&&!(null!==(t=this.timeExtent)&&void 0!==t&&t.isEmpty)}};return(0,i._)([(0,r.MZ)()],e.prototype,"layer",void 0),(0,i._)([(0,r.MZ)()],e.prototype,"suspended",void 0),(0,i._)([(0,r.MZ)({readOnly:!0})],e.prototype,"timeExtent",null),(0,i._)([(0,r.MZ)()],e.prototype,"view",void 0),e=(0,i._)([(0,u.$)("esri.views.layers.ImageryLayerView")],e),e}},43543:(t,e,n)=>{n.d(e,{F:()=>l});var i=n(98156);function l(t,e,n){if(null==(null===t||void 0===t?void 0:t.timeInfo))return null;const{datesInUnknownTimezone:l=!1,timeOffset:o,useViewTime:r}=t;let u=t.timeExtent;l&&(u=(0,i.toLocalTimeExtent)(u));let a=r?e&&u?e.intersection(u):e||u:u;return!a||a.isEmpty||a.isAllTime?a:(o&&(a=a.offset(-o.value,o.unit)),l&&(a=(0,i.toUTCTimeExtent)(a)),a.equals(n)?n:a)}},98156:(t,e,n)=>{n.r(e),n.d(e,{getTimeExtentFromLayers:()=>c,getTimeSliderSettingsFromWebDocument:()=>v,toLocalTimeExtent:()=>w,toUTCTimeExtent:()=>p});var i=n(18690),l=n(53084),o=n(18288),r=n(59187),u=n(42052),a=n(72027);function s(t){return void 0!==t.timeInfo}async function d(t,e){var n,i;return null!==(n=null===(i=t.widgets)||void 0===i||null===(i=i.timeSlider)||void 0===i?void 0:i.fullTimeExtent)&&void 0!==n?n:c(t.allLayers,e)}function m(t){const{numStops:e,stopInterval:n,stops:i}=t;return i?{dates:(0,l.clone)(i)}:n?{interval:n.clone()}:{count:null!==e&&void 0!==e?e:5}}async function c(t,e){if(0===t.length)return r.default.allTime;await Promise.all(t.map(t=>t.load({signal:e})));const n=t.filter(s),l=t.filter(t=>!s(t)&&null!=t.visibilityTimeExtent);if(0===n.length&&0===l.length)return r.default.allTime;const o=[],u=[];for(const i of n){var a;"feature"!==(null===i||void 0===i?void 0:i.type)&&"map-image"!==(null===i||void 0===i?void 0:i.type)||null===(a=i.timeInfo)||void 0===a||!a.hasLiveData?u.push(i):o.push(i)}const d=t=>null==t||t.isAllTime,m=[...u.map(t=>{var e,n;const i=null===(e=t.timeInfo)||void 0===e?void 0:e.fullTimeExtent,{visibilityTimeExtent:l}=t;return null!==(n=null===i||void 0===i?void 0:i.intersection(l))&&void 0!==n?n:l}),...l.map(t=>t.visibilityTimeExtent)];if(m.some(d))return r.default.allTime;const c=o.map(async t=>{var n,i,l,o;const r=null!==(n=null===(i=await t.fetchRecomputedExtents({signal:e}))||void 0===i?void 0:i.timeExtent)&&void 0!==n?n:null===(l=t.timeInfo)||void 0===l?void 0:l.fullTimeExtent,{visibilityTimeExtent:u}=t;return null!==(o=null===r||void 0===r?void 0:r.intersection(u))&&void 0!==o?o:u}),f=(await Promise.allSettled(c)).map(t=>"fulfilled"===t.status?t.value:null);if(f.some(d))return r.default.allTime;const v=[...f,...m].filter(i.Ru);return 0===v.length?r.default.allTime:v.reduce((t,e)=>t.union(e))}function f(t,e){var n;const i=t.currentTimeExtent;if(!i)return null;const{start:l,end:o}=i,u=null!==(n=null!==l&&void 0!==l?l:o)&&void 0!==n?n:null;switch(e){case"time-window":return new r.default({start:l,end:o});case"cumulative-from-start":return new r.default({start:null,end:u});case"cumulative-from-end":return new r.default({start:u,end:null});case"instant":return new r.default({start:u,end:u})}}async function v(t,e){var n,i;if(!(0,u.r)(t)&&!function(t){return null!=t&&"object"==typeof t&&a.X in t}(t))return null;await t.load({signal:e});const l=null===t||void 0===t||null===(n=t.widgets)||void 0===n?void 0:n.timeSlider;if(!l)return null;const o=await d(t,e),r=l.loop,s=function(t){var e;const n=null!==(e=t.numThumbs)&&void 0!==e?e:2,i=t.currentTimeExtent;if(i){const{start:t,end:e}=i;return null!=t&&null!=e&&t.getTime()===e.getTime()?"instant":2===n?"time-window":null==t||0===t.getTime()?"cumulative-from-start":"cumulative-from-end"}return 2===n?"time-window":"cumulative-from-start"}(l);return{fullTimeExtent:o,loop:r,mode:s,playRate:null!==(i=l.stopDelay)&&void 0!==i?i:2e3,stops:m(l),timeExtent:f(l,s)}}function p(t){if(!t)return t;const{start:e,end:n}=t;return new r.default({start:null!=e?(0,o.S1)(e,-e.getTimezoneOffset(),"minutes"):e,end:null!=n?(0,o.S1)(n,-n.getTimezoneOffset(),"minutes"):n})}function w(t){if(!t)return t;const{start:e,end:n}=t;return new r.default({start:null!=e?(0,o.S1)(e,e.getTimezoneOffset(),"minutes"):e,end:null!=n?(0,o.S1)(n,n.getTimezoneOffset(),"minutes"):n})}}}]);
//# sourceMappingURL=17214.2905fa40.chunk.js.map