"use strict";(self.webpackChunks06_station=self.webpackChunks06_station||[]).push([[13230,98156],{13230:(t,e,n)=>{n.r(e),n.d(e,{default:()=>m});var i=n(35143),l=(n(76460),n(81806),n(47249),n(50076),n(85842)),r=n(10183),o=n(47777),s=n(58423),u=n(55754);let a=class extends((0,o.A)(r.A)){constructor(){super(...arguments),this.type="map-image-3d"}initialize(){this._updatingHandles.add(()=>this.exportImageVersion,()=>this._updatingHandles.addPromise(this.refreshDebounced())),this._popupHighlightHelper=new s.Uh({createFetchPopupFeaturesQueryGeometry:(t,e)=>(0,u.V)(t,e,this.view),layerView:this,updatingHandles:this._updatingHandles})}destroy(){var t;null===(t=this._popupHighlightHelper)||void 0===t||t.destroy()}fetchPopupFeaturesAtLocation(t,e){return this._popupHighlightHelper.fetchPopupFeaturesAtLocation(t,e)}getFetchOptions(){return{timeExtent:this.timeExtent}}};a=(0,i._)([(0,l.$)("esri.views.3d.layers.MapImageLayerView3D")],a);const m=a},43543:(t,e,n)=>{n.d(e,{F:()=>l});var i=n(98156);function l(t,e,n){if(null==(null===t||void 0===t?void 0:t.timeInfo))return null;const{datesInUnknownTimezone:l=!1,timeOffset:r,useViewTime:o}=t;let s=t.timeExtent;l&&(s=(0,i.toLocalTimeExtent)(s));let u=o?e&&s?e.intersection(s):e||s:s;return!u||u.isEmpty||u.isAllTime?u:(r&&(u=u.offset(-r.value,r.unit)),l&&(u=(0,i.toUTCTimeExtent)(u)),u.equals(n)?n:u)}},47777:(t,e,n)=>{n.d(e,{A:()=>u});var i=n(35143),l=n(46053),r=(n(81806),n(76460),n(47249),n(85842)),o=n(1420),s=n(43543);const u=t=>{let e=class extends t{initialize(){this.exportImageParameters=new o.g({layer:this.layer})}destroy(){this.exportImageParameters.destroy(),this.exportImageParameters=null}get floors(){var t,e;return null!==(t=null===(e=this.view)||void 0===e?void 0:e.floors)&&void 0!==t?t:null}get exportImageVersion(){var t;return null!==(t=this.exportImageParameters)&&void 0!==t&&t.commitProperty("version"),this.commitProperty("timeExtent"),this.commitProperty("floors"),(this._get("exportImageVersion")||0)+1}get timeExtent(){var t;return(0,s.F)(this.layer,null===(t=this.view)||void 0===t?void 0:t.timeExtent,this._get("timeExtent"))}canResume(){var t;return!!super.canResume()&&!(null!==(t=this.timeExtent)&&void 0!==t&&t.isEmpty)}};return(0,i._)([(0,l.MZ)()],e.prototype,"exportImageParameters",void 0),(0,i._)([(0,l.MZ)({readOnly:!0})],e.prototype,"floors",null),(0,i._)([(0,l.MZ)({readOnly:!0})],e.prototype,"exportImageVersion",null),(0,i._)([(0,l.MZ)()],e.prototype,"layer",void 0),(0,i._)([(0,l.MZ)()],e.prototype,"suspended",void 0),(0,i._)([(0,l.MZ)({readOnly:!0})],e.prototype,"timeExtent",null),e=(0,i._)([(0,r.$)("esri.views.layers.MapImageLayerView")],e),e}},98156:(t,e,n)=>{n.r(e),n.d(e,{getTimeExtentFromLayers:()=>c,getTimeSliderSettingsFromWebDocument:()=>f,toLocalTimeExtent:()=>h,toUTCTimeExtent:()=>p});var i=n(18690),l=n(53084),r=n(18288),o=n(59187),s=n(42052),u=n(72027);function a(t){return void 0!==t.timeInfo}async function m(t,e){var n,i;return null!==(n=null===(i=t.widgets)||void 0===i||null===(i=i.timeSlider)||void 0===i?void 0:i.fullTimeExtent)&&void 0!==n?n:c(t.allLayers,e)}function d(t){const{numStops:e,stopInterval:n,stops:i}=t;return i?{dates:(0,l.clone)(i)}:n?{interval:n.clone()}:{count:null!==e&&void 0!==e?e:5}}async function c(t,e){if(0===t.length)return o.default.allTime;await Promise.all(t.map(t=>t.load({signal:e})));const n=t.filter(a),l=t.filter(t=>!a(t)&&null!=t.visibilityTimeExtent);if(0===n.length&&0===l.length)return o.default.allTime;const r=[],s=[];for(const i of n){var u;"feature"!==(null===i||void 0===i?void 0:i.type)&&"map-image"!==(null===i||void 0===i?void 0:i.type)||null===(u=i.timeInfo)||void 0===u||!u.hasLiveData?s.push(i):r.push(i)}const m=t=>null==t||t.isAllTime,d=[...s.map(t=>{var e,n;const i=null===(e=t.timeInfo)||void 0===e?void 0:e.fullTimeExtent,{visibilityTimeExtent:l}=t;return null!==(n=null===i||void 0===i?void 0:i.intersection(l))&&void 0!==n?n:l}),...l.map(t=>t.visibilityTimeExtent)];if(d.some(m))return o.default.allTime;const c=r.map(async t=>{var n,i,l,r;const o=null!==(n=null===(i=await t.fetchRecomputedExtents({signal:e}))||void 0===i?void 0:i.timeExtent)&&void 0!==n?n:null===(l=t.timeInfo)||void 0===l?void 0:l.fullTimeExtent,{visibilityTimeExtent:s}=t;return null!==(r=null===o||void 0===o?void 0:o.intersection(s))&&void 0!==r?r:s}),v=(await Promise.allSettled(c)).map(t=>"fulfilled"===t.status?t.value:null);if(v.some(m))return o.default.allTime;const f=[...v,...d].filter(i.Ru);return 0===f.length?o.default.allTime:f.reduce((t,e)=>t.union(e))}function v(t,e){var n;const i=t.currentTimeExtent;if(!i)return null;const{start:l,end:r}=i,s=null!==(n=null!==l&&void 0!==l?l:r)&&void 0!==n?n:null;switch(e){case"time-window":return new o.default({start:l,end:r});case"cumulative-from-start":return new o.default({start:null,end:s});case"cumulative-from-end":return new o.default({start:s,end:null});case"instant":return new o.default({start:s,end:s})}}async function f(t,e){var n,i;if(!(0,s.r)(t)&&!function(t){return null!=t&&"object"==typeof t&&u.X in t}(t))return null;await t.load({signal:e});const l=null===t||void 0===t||null===(n=t.widgets)||void 0===n?void 0:n.timeSlider;if(!l)return null;const r=await m(t,e),o=l.loop,a=function(t){var e;const n=null!==(e=t.numThumbs)&&void 0!==e?e:2,i=t.currentTimeExtent;if(i){const{start:t,end:e}=i;return null!=t&&null!=e&&t.getTime()===e.getTime()?"instant":2===n?"time-window":null==t||0===t.getTime()?"cumulative-from-start":"cumulative-from-end"}return 2===n?"time-window":"cumulative-from-start"}(l);return{fullTimeExtent:r,loop:o,mode:a,playRate:null!==(i=l.stopDelay)&&void 0!==i?i:2e3,stops:d(l),timeExtent:v(l,a)}}function p(t){if(!t)return t;const{start:e,end:n}=t;return new o.default({start:null!=e?(0,r.S1)(e,-e.getTimezoneOffset(),"minutes"):e,end:null!=n?(0,r.S1)(n,-n.getTimezoneOffset(),"minutes"):n})}function h(t){if(!t)return t;const{start:e,end:n}=t;return new o.default({start:null!=e?(0,r.S1)(e,e.getTimezoneOffset(),"minutes"):e,end:null!=n?(0,r.S1)(n,n.getTimezoneOffset(),"minutes"):n})}}}]);
//# sourceMappingURL=13230.26fe7319.chunk.js.map